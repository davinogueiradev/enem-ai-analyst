
[
  {
    "query": "Qual a nota média em matemática por estado?",
    "expected_sql": "SELECT SG_UF_PROVA, AVG(NU_NOTA_MT) FROM enem_2023_enriched GROUP BY SG_UF_PROVA;",
    "reference_response": "A nota média em matemática por estado é X para o estado A, Y para o estado B, etc."
  },
  {
    "query": "Quantos participantes fizeram a prova em cada estado?",
    "expected_sql": "SELECT SG_UF_PROVA, COUNT(*) as total_participantes FROM enem_2023_enriched GROUP BY SG_UF_PROVA ORDER BY total_participantes DESC;",
    "reference_response": "Número de participantes por estado ordenado do maior para o menor."
  },
  {
    "query": "Qual a maior nota de redação obtida?",
    "expected_sql": "SELECT MAX(NU_NOTA_REDACAO) as maior_nota_redacao FROM enem_2023_enriched WHERE NU_NOTA_REDACAO IS NOT NULL;",
    "reference_response": "A maior nota de redação obtida foi X pontos."
  },
  {
    "query": "Quantos participantes são do sexo feminino?",
    "expected_sql": "SELECT COUNT(*) as total_feminino FROM enem_2023_enriched WHERE TP_SEXO_DESC = 'Feminino';",
    "reference_response": "Total de participantes do sexo feminino."
  },
  {
    "query": "Qual a média das notas de ciências da natureza por faixa etária?",
    "expected_sql": "SELECT TP_FAIXA_ETARIA_DESC, AVG(NU_NOTA_CN) as media_cn FROM enem_2023_enriched WHERE NU_NOTA_CN IS NOT NULL GROUP BY TP_FAIXA_ETARIA_DESC ORDER BY media_cn DESC;",
    "reference_response": "Média das notas de ciências da natureza por faixa etária."
  },
  {
    "query": "Quantos participantes são treineiros?",
    "expected_sql": "SELECT COUNT(*) as total_treineiros FROM enem_2023_enriched WHERE IN_TREINEIRO_DESC = 'Sim';",
    "reference_response": "Total de participantes treineiros."
  },
  {
    "query": "Qual a nota média em linguagens e códigos por tipo de escola?",
    "expected_sql": "SELECT TP_ESCOLA_DESC, AVG(NU_NOTA_LC) as media_lc FROM enem_2023_enriched WHERE NU_NOTA_LC IS NOT NULL GROUP BY TP_ESCOLA_DESC;",
    "reference_response": "Nota média em linguagens e códigos por tipo de escola (pública/privada)."
  },
  {
    "query": "Quantos participantes escolheram inglês como língua estrangeira?",
    "expected_sql": "SELECT COUNT(*) as total_ingles FROM enem_2023_enriched WHERE TP_LINGUA_DESC LIKE '%Inglês%';",
    "reference_response": "Total de participantes que escolheram inglês."
  },
  {
    "query": "Qual a distribuição de participantes por cor/raça?",
    "expected_sql": "SELECT TP_COR_RACA_DESC, COUNT(*) as total FROM enem_2023_enriched GROUP BY TP_COR_RACA_DESC ORDER BY total DESC;",
    "reference_response": "Distribuição de participantes por cor/raça."
  },
  {
    "query": "Qual a maior nota em ciências humanas?",
    "expected_sql": "SELECT MAX(NU_NOTA_CH) as maior_nota_ch FROM enem_2023_enriched WHERE NU_NOTA_CH IS NOT NULL;",
    "reference_response": "A maior nota em ciências humanas obtida."
  },
  {
    "query": "Quantos participantes faltaram na prova de matemática?",
    "expected_sql": "SELECT COUNT(*) as total_ausentes_mt FROM enem_2023_enriched WHERE TP_PRESENCA_MT_DESC = 'Faltou à prova';",
    "reference_response": "Total de participantes que faltaram na prova de matemática."
  },
  {
    "query": "Qual a média geral das 4 provas objetivas?",
    "expected_sql": "SELECT AVG((NU_NOTA_CN + NU_NOTA_CH + NU_NOTA_LC + NU_NOTA_MT)/4) as media_geral FROM enem_2023_enriched WHERE NU_NOTA_CN IS NOT NULL AND NU_NOTA_CH IS NOT NULL AND NU_NOTA_LC IS NOT NULL AND NU_NOTA_MT IS NOT NULL;",
    "reference_response": "Média geral das quatro provas objetivas."
  },
  {
    "query": "Quantos participantes são de escolas rurais?",
    "expected_sql": "SELECT COUNT(*) as total_rural FROM enem_2023_enriched WHERE TP_LOCALIZACAO_ESC_DESC = 'Rural';",
    "reference_response": "Total de participantes de escolas rurais."
  },
  {
    "query": "Qual estado teve a maior média em redação?",
    "expected_sql": "SELECT SG_UF_PROVA, AVG(NU_NOTA_REDACAO) as media_redacao FROM enem_2023_enriched WHERE NU_NOTA_REDACAO IS NOT NULL GROUP BY SG_UF_PROVA ORDER BY media_redacao DESC LIMIT 1;",
    "reference_response": "Estado com maior média em redação."
  },
  {
    "query": "Quantos participantes concluíram o ensino médio em 2023?",
    "expected_sql": "SELECT COUNT(*) as total_2023 FROM enem_2023_enriched WHERE TP_ANO_CONCLUIU_DESC = '2023';",
    "reference_response": "Total de participantes que concluíram o ensino médio em 2023."
  },
  {
    "query": "Qual a distribuição por estado civil?",
    "expected_sql": "SELECT TP_ESTADO_CIVIL_DESC, COUNT(*) as total FROM enem_2023_enriched GROUP BY TP_ESTADO_CIVIL_DESC ORDER BY total DESC;",
    "reference_response": "Distribuição de participantes por estado civil."
  },
  {
    "query": "Quantos participantes tiveram nota zero em redação?",
    "expected_sql": "SELECT COUNT(*) as total_zero_redacao FROM enem_2023_enriched WHERE NU_NOTA_REDACAO = 0;",
    "reference_response": "Total de participantes com nota zero em redação."
  },
  {
    "query": "Qual a nota média em matemática por sexo?",
    "expected_sql": "SELECT TP_SEXO_DESC, AVG(NU_NOTA_MT) as media_mt FROM enem_2023_enriched WHERE NU_NOTA_MT IS NOT NULL GROUP BY TP_SEXO_DESC;",
    "reference_response": "Nota média em matemática por sexo."
  },
  {
    "query": "Quantos participantes são de escolas federais?",
    "expected_sql": "SELECT COUNT(*) as total_federal FROM enem_2023_enriched WHERE TP_DEPENDENCIA_ADM_ESC_DESC = 'Federal';",
    "reference_response": "Total de participantes de escolas federais."
  },
  {
    "query": "Qual município teve mais participantes?",
    "expected_sql": "SELECT NO_MUNICIPIO_PROVA, COUNT(*) as total FROM enem_2023_enriched GROUP BY NO_MUNICIPIO_PROVA ORDER BY total DESC LIMIT 1;",
    "reference_response": "Município com maior número de participantes."
  },
  {
    "query": "Quantos participantes tiraram nota máxima (1000) em matemática?",
    "expected_sql": "SELECT COUNT(*) as total_1000_mt FROM enem_2023_enriched WHERE NU_NOTA_MT = 1000;",
    "reference_response": "Total de participantes com nota máxima em matemática."
  },
  {
    "query": "Qual a média das 5 competências da redação?",
    "expected_sql": "SELECT AVG(NU_NOTA_COMP1) as media_comp1, AVG(NU_NOTA_COMP2) as media_comp2, AVG(NU_NOTA_COMP3) as media_comp3, AVG(NU_NOTA_COMP4) as media_comp4, AVG(NU_NOTA_COMP5) as media_comp5 FROM enem_2023_enriched WHERE NU_NOTA_COMP1 IS NOT NULL;",
    "reference_response": "Média de cada uma das 5 competências da redação."
  },
  {
    "query": "Quantos participantes são casados?",
    "expected_sql": "SELECT COUNT(*) as total_casados FROM enem_2023_enriched WHERE TP_ESTADO_CIVIL_DESC = 'Casado(a)';",
    "reference_response": "Total de participantes casados."
  },
  {
    "query": "Qual a menor nota em ciências da natureza?",
    "expected_sql": "SELECT MIN(NU_NOTA_CN) as menor_nota_cn FROM enem_2023_enriched WHERE NU_NOTA_CN IS NOT NULL;",
    "reference_response": "A menor nota em ciências da natureza obtida."
  },
  {
    "query": "Quantos participantes escolheram espanhol?",
    "expected_sql": "SELECT COUNT(*) as total_espanhol FROM enem_2023_enriched WHERE TP_LINGUA_DESC LIKE '%Espanhol%';",
    "reference_response": "Total de participantes que escolheram espanhol."
  },
  {
    "query": "Qual a média de idade dos participantes?",
    "expected_sql": "SELECT TP_FAIXA_ETARIA_DESC, COUNT(*) as total FROM enem_2023_enriched GROUP BY TP_FAIXA_ETARIA_DESC ORDER BY total DESC;",
    "reference_response": "Distribuição dos participantes por faixa etária."
  },
  {
    "query": "Quantos participantes são pardos?",
    "expected_sql": "SELECT COUNT(*) as total_pardos FROM enem_2023_enriched WHERE TP_COR_RACA_DESC = 'Parda';",
    "reference_response": "Total de participantes pardos."
  },
  {
    "query": "Qual a nota média em ciências humanas por tipo de escola?",
    "expected_sql": "SELECT TP_ESCOLA_DESC, AVG(NU_NOTA_CH) as media_ch FROM enem_2023_enriched WHERE NU_NOTA_CH IS NOT NULL GROUP BY TP_ESCOLA_DESC;",
    "reference_response": "Nota média em ciências humanas por tipo de escola."
  },
  {
    "query": "Quantos participantes foram eliminados em alguma prova?",
    "expected_sql": "SELECT COUNT(*) as total_eliminados FROM enem_2023_enriched WHERE TP_PRESENCA_CN_DESC = 'Eliminado' OR TP_PRESENCA_CH_DESC = 'Eliminado' OR TP_PRESENCA_LC_DESC = 'Eliminado' OR TP_PRESENCA_MT_DESC = 'Eliminado';",
    "reference_response": "Total de participantes eliminados em pelo menos uma prova."
  },
  {
    "query": "Qual a distribuição de nacionalidade dos participantes?",
    "expected_sql": "SELECT TP_NACIONALIDADE_DESC, COUNT(*) as total FROM enem_2023_enriched GROUP BY TP_NACIONALIDADE_DESC ORDER BY total DESC;",
    "reference_response": "Distribuição de participantes por nacionalidade."
  },
  {
    "query": "Quantos participantes têm 17 anos?",
    "expected_sql": "SELECT COUNT(*) as total_17_anos FROM enem_2023_enriched WHERE TP_FAIXA_ETARIA_DESC = '17 anos';",
    "reference_response": "Total de participantes de 17 anos."
  },
  {
    "query": "Qual a correlação entre notas de matemática e ciências da natureza?",
    "expected_sql": "SELECT NU_NOTA_MT, NU_NOTA_CN FROM enem_2023_enriched WHERE NU_NOTA_MT IS NOT NULL AND NU_NOTA_CN IS NOT NULL LIMIT 1000;",
    "reference_response": "Dados para análise de correlação entre matemática e ciências da natureza."
  },
  {
    "query": "Quantos participantes são de escolas estaduais?",
    "expected_sql": "SELECT COUNT(*) as total_estadual FROM enem_2023_enriched WHERE TP_DEPENDENCIA_ADM_ESC_DESC = 'Estadual';",
    "reference_response": "Total de participantes de escolas estaduais."
  },
  {
    "query": "Qual estado teve menor média em matemática?",
    "expected_sql": "SELECT SG_UF_PROVA, AVG(NU_NOTA_MT) as media_mt FROM enem_2023_enriched WHERE NU_NOTA_MT IS NOT NULL GROUP BY SG_UF_PROVA ORDER BY media_mt ASC LIMIT 1;",
    "reference_response": "Estado com menor média em matemática."
  },
  {
    "query": "Quantos participantes tiveram redação anulada?",
    "expected_sql": "SELECT COUNT(*) as total_anulada FROM enem_2023_enriched WHERE TP_STATUS_REDACAO_DESC = 'Anulada';",
    "reference_response": "Total de participantes com redação anulada."
  },
  {
    "query": "Qual a média de linguagens e códigos por cor/raça?",
    "expected_sql": "SELECT TP_COR_RACA_DESC, AVG(NU_NOTA_LC) as media_lc FROM enem_2023_enriched WHERE NU_NOTA_LC IS NOT NULL GROUP BY TP_COR_RACA_DESC ORDER BY media_lc DESC;",
    "reference_response": "Média de linguagens e códigos por cor/raça."
  },
  {
    "query": "Quantos participantes não concluíram o ensino médio?",
    "expected_sql": "SELECT COUNT(*) as total_nao_concluiu FROM enem_2023_enriched WHERE TP_ST_CONCLUSAO_DESC != 'Já concluí o Ensino Médio';",
    "reference_response": "Total de participantes que não concluíram o ensino médio."
  },
  {
    "query": "Qual a maior diferença entre notas de um mesmo participante?",
    "expected_sql": "SELECT MAX(GREATEST(NU_NOTA_CN, NU_NOTA_CH, NU_NOTA_LC, NU_NOTA_MT) - LEAST(NU_NOTA_CN, NU_NOTA_CH, NU_NOTA_LC, NU_NOTA_MT)) as maior_diferenca FROM enem_2023_enriched WHERE NU_NOTA_CN IS NOT NULL AND NU_NOTA_CH IS NOT NULL AND NU_NOTA_LC IS NOT NULL AND NU_NOTA_MT IS NOT NULL;",
    "reference_response": "Maior diferença entre as notas de um mesmo participante."
  },
  {
    "query": "Quantos participantes são brancos?",
    "expected_sql": "SELECT COUNT(*) as total_brancos FROM enem_2023_enriched WHERE TP_COR_RACA_DESC = 'Branca';",
    "reference_response": "Total de participantes brancos."
  },
  {
    "query": "Qual a nota média de redação por estado?",
    "expected_sql": "SELECT SG_UF_PROVA, AVG(NU_NOTA_REDACAO) as media_redacao FROM enem_2023_enriched WHERE NU_NOTA_REDACAO IS NOT NULL GROUP BY SG_UF_PROVA ORDER BY media_redacao DESC;",
    "reference_response": "Nota média de redação por estado."
  },
  {
    "query": "Quantos participantes fizeram EJA?",
    "expected_sql": "SELECT COUNT(*) as total_eja FROM enem_2023_enriched WHERE TP_ENSINO_DESC LIKE '%EJA%';",
    "reference_response": "Total de participantes que fizeram EJA."
  },
  {
    "query": "Qual a distribuição por tipo de ensino?",
    "expected_sql": "SELECT TP_ENSINO_DESC, COUNT(*) as total FROM enem_2023_enriched GROUP BY TP_ENSINO_DESC ORDER BY total DESC;",
    "reference_response": "Distribuição de participantes por tipo de ensino."
  },
  {
    "query": "Quantos participantes têm mais de 30 anos?",
    "expected_sql": "SELECT COUNT(*) as total_mais_30 FROM enem_2023_enriched WHERE TP_FAIXA_ETARIA_DESC IN ('Entre 31 e 35 anos', 'Entre 36 e 40 anos', 'Entre 41 e 45 anos', 'Entre 46 e 50 anos', 'Entre 51 e 55 anos', 'Entre 56 e 60 anos', 'Maior de 60 anos');",
    "reference_response": "Total de participantes com mais de 30 anos."
  },
  {
    "query": "Qual a competência de redação com maior média?",
    "expected_sql": "SELECT 'Comp1' as competencia, AVG(NU_NOTA_COMP1) as media FROM enem_2023_enriched WHERE NU_NOTA_COMP1 IS NOT NULL UNION SELECT 'Comp2', AVG(NU_NOTA_COMP2) FROM enem_2023_enriched WHERE NU_NOTA_COMP2 IS NOT NULL UNION SELECT 'Comp3', AVG(NU_NOTA_COMP3) FROM enem_2023_enriched WHERE NU_NOTA_COMP3 IS NOT NULL UNION SELECT 'Comp4', AVG(NU_NOTA_COMP4) FROM enem_2023_enriched WHERE NU_NOTA_COMP4 IS NOT NULL UNION SELECT 'Comp5', AVG(NU_NOTA_COMP5) FROM enem_2023_enriched WHERE NU_NOTA_COMP5 IS NOT NULL ORDER BY media DESC;",
    "reference_response": "Competência de redação com maior média."
  },
  {
    "query": "Quantos participantes são de escolas municipais?",
    "expected_sql": "SELECT COUNT(*) as total_municipal FROM enem_2023_enriched WHERE TP_DEPENDENCIA_ADM_ESC_DESC = 'Municipal';",
    "reference_response": "Total de participantes de escolas municipais."
  },
  {
    "query": "Qual a média de ciências da natureza por sexo?",
    "expected_sql": "SELECT TP_SEXO_DESC, AVG(NU_NOTA_CN) as media_cn FROM enem_2023_enriched WHERE NU_NOTA_CN IS NOT NULL GROUP BY TP_SEXO_DESC;",
    "reference_response": "Média de ciências da natureza por sexo."
  },
  {
    "query": "Quantos participantes entregaram redação em branco?",
    "expected_sql": "SELECT COUNT(*) as total_branco FROM enem_2023_enriched WHERE TP_STATUS_REDACAO_DESC = 'Em Branco';",
    "reference_response": "Total de participantes que entregaram redação em branco."
  },
  {
    "query": "Qual a distribuição de participantes por região?",
    "expected_sql": "SELECT SG_UF_PROVA, COUNT(*) as total FROM enem_2023_enriched GROUP BY SG_UF_PROVA ORDER BY total DESC;",
    "reference_response": "Distribuição de participantes por estado/região."
  },
  {
    "query": "Quantos participantes são pretos?",
    "expected_sql": "SELECT COUNT(*) as total_pretos FROM enem_2023_enriched WHERE TP_COR_RACA_DESC = 'Preta';",
    "reference_response": "Total de participantes pretos."
  },
  {
    "query": "Qual a nota mais comum em matemática?",
    "expected_sql": "SELECT NU_NOTA_MT, COUNT(*) as frequencia FROM enem_2023_enriched WHERE NU_NOTA_MT IS NOT NULL GROUP BY NU_NOTA_MT ORDER BY frequencia DESC LIMIT 1;",
    "reference_response": "Nota mais frequente em matemática."
  },
  {
    "query": "Quantos participantes são solteiros?",
    "expected_sql": "SELECT COUNT(*) as total_solteiros FROM enem_2023_enriched WHERE TP_ESTADO_CIVIL_DESC = 'Solteiro(a)';",
    "reference_response": "Total de participantes solteiros."
  },
  {
    "query": "Qual a média de ciências humanas por faixa etária?",
    "expected_sql": "SELECT TP_FAIXA_ETARIA_DESC, AVG(NU_NOTA_CH) as media_ch FROM enem_2023_enriched WHERE NU_NOTA_CH IS NOT NULL GROUP BY TP_FAIXA_ETARIA_DESC ORDER BY media_ch DESC;",
    "reference_response": "Média de ciências humanas por faixa etária."
  },
  {
    "query": "Quantos participantes estudaram em escolas extintas?",
    "expected_sql": "SELECT COUNT(*) as total_extintas FROM enem_2023_enriched WHERE TP_SIT_FUNC_ESC_DESC = 'Extinta';",
    "reference_response": "Total de participantes de escolas extintas."
  },
  {
    "query": "Qual o percentual de presença em cada prova?",
    "expected_sql": "SELECT 'CN' as prova, (SUM(CASE WHEN TP_PRESENCA_CN_DESC = 'Presente' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) as percentual_presenca FROM enem_2023_enriched UNION SELECT 'CH', (SUM(CASE WHEN TP_PRESENCA_CH_DESC = 'Presente' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) FROM enem_2023_enriched UNION SELECT 'LC', (SUM(CASE WHEN TP_PRESENCA_LC_DESC = 'Presente' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) FROM enem_2023_enriched UNION SELECT 'MT', (SUM(CASE WHEN TP_PRESENCA_MT_DESC = 'Presente' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)) FROM enem_2023_enriched;",
    "reference_response": "Percentual de presença em cada prova."
  },
  {
    "query": "Quantos participantes são indígenas?",
    "expected_sql": "SELECT COUNT(*) as total_indigenas FROM enem_2023_enriched WHERE TP_COR_RACA_DESC = 'Indígena';",
    "reference_response": "Total de participantes indígenas."
  },
  {
    "query": "Qual a média geral por dependência administrativa da escola?",
    "expected_sql": "SELECT TP_DEPENDENCIA_ADM_ESC_DESC, AVG((NU_NOTA_CN + NU_NOTA_CH + NU_NOTA_LC + NU_NOTA_MT)/4) as media_geral FROM enem_2023_enriched WHERE NU_NOTA_CN IS NOT NULL AND NU_NOTA_CH IS NOT NULL AND NU_NOTA_LC IS NOT NULL AND NU_NOTA_MT IS NOT NULL GROUP BY TP_DEPENDENCIA_ADM_ESC_DESC ORDER BY media_geral DESC;",
    "reference_response": "Média geral por dependência administrativa da escola."
  },
  {
    "query": "Quantos participantes têm 18 anos?",
    "expected_sql": "SELECT COUNT(*) as total_18_anos FROM enem_2023_enriched WHERE TP_FAIXA_ETARIA_DESC = '18 anos';",
    "reference_response": "Total de participantes de 18 anos."
  },
  {
    "query": "Qual a maior nota obtida em todas as provas?",
    "expected_sql": "SELECT MAX(GREATEST(NU_NOTA_CN, NU_NOTA_CH, NU_NOTA_LC, NU_NOTA_MT)) as maior_nota_geral FROM enem_2023_enriched WHERE NU_NOTA_CN IS NOT NULL AND NU_NOTA_CH IS NOT NULL AND NU_NOTA_LC IS NOT NULL AND NU_NOTA_MT IS NOT NULL;",
    "reference_response": "Maior nota obtida considerando todas as provas."
  },
  {
    "query": "Quantos participantes são de escolas privadas?",
    "expected_sql": "SELECT COUNT(*) as total_privada FROM enem_2023_enriched WHERE TP_ESCOLA_DESC = 'Privada';",
    "reference_response": "Total de participantes de escolas privadas."
  },
  {
    "query": "Qual a distribuição de status da redação?",
    "expected_sql": "SELECT TP_STATUS_REDACAO_DESC, COUNT(*) as total FROM enem_2023_enriched GROUP BY TP_STATUS_REDACAO_DESC ORDER BY total DESC;",
    "reference_response": "Distribuição por status da redação."
  },
  {
    "query": "Quantos participantes são amarelos?",
    "expected_sql": "SELECT COUNT(*) as total_amarelos FROM enem_2023_enriched WHERE TP_COR_RACA_DESC = 'Amarela';",
    "reference_response": "Total de participantes amarelos."
  },
  {
    "query": "Qual a nota média por localização da escola?",
    "expected_sql": "SELECT TP_LOCALIZACAO_ESC_DESC, AVG((NU_NOTA_CN + NU_NOTA_CH + NU_NOTA_LC + NU_NOTA_MT)/4) as media_geral FROM enem_2023_enriched WHERE NU_NOTA_CN IS NOT NULL AND NU_NOTA_CH IS NOT NULL AND NU_NOTA_LC IS NOT NULL AND NU_NOTA_MT IS NOT NULL GROUP BY TP_LOCALIZACAO_ESC_DESC;",
    "reference_response": "Nota média geral por localização da escola (urbana/rural)."
  },
  {
    "query": "Quantos participantes são divorciados?",
    "expected_sql": "SELECT COUNT(*) as total_divorciados FROM enem_2023_enriched WHERE TP_ESTADO_CIVIL_DESC = 'Divorciado(a)';",
    "reference_response": "Total de participantes divorciados."
  },
  {
    "query": "Qual a correlação entre redação e linguagens?",
    "expected_sql": "SELECT NU_NOTA_REDACAO, NU_NOTA_LC FROM enem_2023_enriched WHERE NU_NOTA_REDACAO IS NOT NULL AND NU_NOTA_LC IS NOT NULL LIMIT 1000;",
    "reference_response": "Dados para análise de correlação entre redação e linguagens."
  },
  {
    "query": "Quantos participantes fizeram todas as 4 provas?",
    "expected_sql": "SELECT COUNT(*) as total_4_provas FROM enem_2023_enriched WHERE TP_PRESENCA_CN_DESC = 'Presente' AND TP_PRESENCA_CH_DESC = 'Presente' AND TP_PRESENCA_LC_DESC = 'Presente' AND TP_PRESENCA_MT_DESC = 'Presente';",
    "reference_response": "Total de participantes que fizeram as 4 provas objetivas."
  },
  {
    "query": "Qual o município com maior média em redação?",
    "expected_sql": "SELECT NO_MUNICIPIO_PROVA, AVG(NU_NOTA_REDACAO) as media_redacao FROM enem_2023_enriched WHERE NU_NOTA_REDACAO IS NOT NULL GROUP BY NO_MUNICIPIO_PROVA HAVING COUNT(*) >= 100 ORDER BY media_redacao DESC LIMIT 1;",
    "reference_response": "Município com maior média em redação (mínimo 100 participantes)."
  },
  {
    "query": "Quantos participantes são viúvos?",
    "expected_sql": "SELECT COUNT(*) as total_viuvos FROM enem_2023_enriched WHERE TP_ESTADO_CIVIL_DESC = 'Viúvo(a)';",
    "reference_response": "Total de participantes viúvos."
  },
  {
    "query": "Qual a variação das notas de matemática?",
    "expected_sql": "SELECT MIN(NU_NOTA_MT) as min_mt, MAX(NU_NOTA_MT) as max_mt, AVG(NU_NOTA_MT) as media_mt, STDDEV(NU_NOTA_MT) as desvio_mt FROM enem_2023_enriched WHERE NU_NOTA_MT IS NOT NULL;",
    "reference_response": "Estatísticas descritivas das notas de matemática."
  },
  {
    "query": "Quantos participantes não informaram cor/raça?",
    "expected_sql": "SELECT COUNT(*) as total_nao_informado FROM enem_2023_enriched WHERE TP_COR_RACA_DESC = 'Não declarado';",
    "reference_response": "Total de participantes que não declararam cor/raça."
  },
  {
    "query": "Qual a média de cada prova por região?",
    "expected_sql": "SELECT SG_UF_PROVA, AVG(NU_NOTA_CN) as media_cn, AVG(NU_NOTA_CH) as media_ch, AVG(NU_NOTA_LC) as media_lc, AVG(NU_NOTA_MT) as media_mt FROM enem_2023_enriched WHERE NU_NOTA_CN IS NOT NULL AND NU_NOTA_CH IS NOT NULL AND NU_NOTA_LC IS NOT NULL AND NU_NOTA_MT IS NOT NULL GROUP BY SG_UF_PROVA ORDER BY SG_UF_PROVA;",
    "reference_response": "Média de cada prova por estado."
  },
  {
    "query": "Quantos participantes concluíram o ensino médio antes de 2020?",
    "expected_sql": "SELECT COUNT(*) as total_antes_2020 FROM enem_2023_enriched WHERE TP_ANO_CONCLUIU_DESC IN ('2019', '2018', '2017', '2016', '2015', '2014', '2013', '2012', '2011', '2010', '2009', '2008', '2007', 'Antes de 2007');",
    "reference_response": "Total de participantes que concluíram antes de 2020."
  },
  {
    "query": "Qual a nota mediana em ciências da natureza?",
    "expected_sql": "SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY NU_NOTA_CN) as mediana_cn FROM enem_2023_enriched WHERE NU_NOTA_CN IS NOT NULL;",
    "reference_response": "Nota mediana em ciências da natureza."
  },
  {
    "query": "Quantos participantes são de cada região do Brasil?",
    "expected_sql": "SELECT CASE WHEN SG_UF_PROVA IN ('AC', 'AP', 'AM', 'PA', 'RO', 'RR', 'TO') THEN 'Norte' WHEN SG_UF_PROVA IN ('AL', 'BA', 'CE', 'MA', 'PB', 'PE', 'PI', 'RN', 'SE') THEN 'Nordeste' WHEN SG_UF_PROVA IN ('DF', 'GO', 'MT', 'MS') THEN 'Centro-Oeste' WHEN SG_UF_PROVA IN ('ES', 'MG', 'RJ', 'SP') THEN 'Sudeste' WHEN SG_UF_PROVA IN ('PR', 'RS', 'SC') THEN 'Sul' END as regiao, COUNT(*) as total FROM enem_2023_enriched GROUP BY CASE WHEN SG_UF_PROVA IN ('AC', 'AP', 'AM', 'PA', 'RO', 'RR', 'TO') THEN 'Norte' WHEN SG_UF_PROVA IN ('AL', 'BA', 'CE', 'MA', 'PB', 'PE', 'PI', 'RN', 'SE') THEN 'Nordeste' WHEN SG_UF_PROVA IN ('DF', 'GO', 'MT', 'MS') THEN 'Centro-Oeste' WHEN SG_UF_PROVA IN ('ES', 'MG', 'RJ', 'SP') THEN 'Sudeste' WHEN SG_UF_PROVA IN ('PR', 'RS', 'SC') THEN 'Sul' END ORDER BY total DESC;",
    "reference_response": "Total de participantes por região do Brasil."
  },
  {
    "query": "Qual a competência de redação com menor média?",
    "expected_sql": "SELECT 'Comp1' as competencia, AVG(NU_NOTA_COMP1) as media FROM enem_2023_enriched WHERE NU_NOTA_COMP1 IS NOT NULL UNION SELECT 'Comp2', AVG(NU_NOTA_COMP2) FROM enem_2023_enriched WHERE NU_NOTA_COMP2 IS NOT NULL UNION SELECT 'Comp3', AVG(NU_NOTA_COMP3) FROM enem_2023_enriched WHERE NU_NOTA_COMP3 IS NOT NULL UNION SELECT 'Comp4', AVG(NU_NOTA_COMP4) FROM enem_2023_enriched WHERE NU_NOTA_COMP4 IS NOT NULL UNION SELECT 'Comp5', AVG(NU_NOTA_COMP5) FROM enem_2023_enriched WHERE NU_NOTA_COMP5 IS NOT NULL ORDER BY media ASC;",
    "reference_response": "Competência de redação com menor média."
  },
  {
    "query": "Quantos participantes estudaram em escolas ativas?",
    "expected_sql": "SELECT COUNT(*) as total_ativas FROM enem_2023_enriched WHERE TP_SIT_FUNC_ESC_DESC = 'Ativa';",
    "reference_response": "Total de participantes de escolas ativas."
  },
  {
    "query": "Qual a diferença entre a maior e menor nota de redação?",
    "expected_sql": "SELECT MAX(NU_NOTA_REDACAO) - MIN(NU_NOTA_REDACAO) as amplitude_redacao FROM enem_2023_enriched WHERE NU_NOTA_REDACAO IS NOT NULL;",
    "reference_response": "Amplitude das notas de redação."
  },
  {
    "query": "Quantos participantes são de escolas públicas?",
    "expected_sql": "SELECT COUNT(*) as total_publica FROM enem_2023_enriched WHERE TP_ESCOLA_DESC = 'Pública';",
    "reference_response": "Total de participantes de escolas públicas."
  },
  {
    "query": "Qual o top 5 de estados com melhores médias gerais?",
    "expected_sql": "SELECT SG_UF_PROVA, AVG((NU_NOTA_CN + NU_NOTA_CH + NU_NOTA_LC + NU_NOTA_MT)/4) as media_geral FROM enem_2023_enriched WHERE NU_NOTA_CN IS NOT NULL AND NU_NOTA_CH IS NOT NULL AND NU_NOTA_LC IS NOT NULL AND NU_NOTA_MT IS NOT NULL GROUP BY SG_UF_PROVA ORDER BY media_geral DESC LIMIT 5;",
    "reference_response": "Top 5 estados com melhores médias gerais."
  },
  {
    "query": "Quantos participantes têm entre 20 e 25 anos?",
    "expected_sql": "SELECT COUNT(*) as total_20_25 FROM enem_2023_enriched WHERE TP_FAIXA_ETARIA_DESC IN ('20 anos', '21 anos', '22 anos', '23 anos', '24 anos', '25 anos');",
    "reference_response": "Total de participantes entre 20 e 25 anos."
  },
  {
    "query": "Qual a distribuição de presença por prova?",
    "expected_sql": "SELECT 'CN' as prova, TP_PRESENCA_CN_DESC as status, COUNT(*) as total FROM enem_2023_enriched GROUP BY TP_PRESENCA_CN_DESC UNION SELECT 'CH', TP_PRESENCA_CH_DESC, COUNT(*) FROM enem_2023_enriched GROUP BY TP_PRESENCA_CH_DESC UNION SELECT 'LC', TP_PRESENCA_LC_DESC, COUNT(*) FROM enem_2023_enriched GROUP BY TP_PRESENCA_LC_DESC UNION SELECT 'MT', TP_PRESENCA_MT_DESC, COUNT(*) FROM enem_2023_enriched GROUP BY TP_PRESENCA_MT_DESC ORDER BY prova, total DESC;",
    "reference_response": "Distribuição de presença/ausência por prova."
  },
  {
    "query": "Quantos participantes são estrangeiros?",
    "expected_sql": "SELECT COUNT(*) as total_estrangeiros FROM enem_2023_enriched WHERE TP_NACIONALIDADE_DESC != 'Brasileira';",
    "reference_response": "Total de participantes estrangeiros."
  },
  {
    "query": "Qual a nota média de redação por sexo?",
    "expected_sql": "SELECT TP_SEXO_DESC, AVG(NU_NOTA_REDACAO) as media_redacao FROM enem_2023_enriched WHERE NU_NOTA_REDACAO IS NOT NULL GROUP BY TP_SEXO_DESC;",
    "reference_response": "Nota média de redação por sexo."
  },
  {
    "query": "Quantos participantes fizeram o ensino médio regular?",
    "expected_sql": "SELECT COUNT(*) as total_regular FROM enem_2023_enriched WHERE TP_ENSINO_DESC = 'Ensino Regular';",
    "reference_response": "Total de participantes do ensino regular."
  },
  {
    "query": "Qual o percentual de participantes por faixa etária?",
    "expected_sql": "SELECT TP_FAIXA_ETARIA_DESC, COUNT(*) * 100.0 / (SELECT COUNT(*) FROM enem_2023_enriched) as percentual FROM enem_2023_enriched GROUP BY TP_FAIXA_ETARIA_DESC ORDER BY percentual DESC;",
    "reference_response": "Percentual de participantes por faixa etária."
  },
  {
    "query": "Quantos participantes tiraram nota 1000 na redação?",
    "expected_sql": "SELECT COUNT(*) as total_1000_redacao FROM enem_2023_enriched WHERE NU_NOTA_REDACAO = 1000;",
    "reference_response": "Total de participantes com nota máxima na redação."
  },
  {
    "query": "Qual a média de linguagens por estado civil?",
    "expected_sql": "SELECT TP_ESTADO_CIVIL_DESC, AVG(NU_NOTA_LC) as media_lc FROM enem_2023_enriched WHERE NU_NOTA_LC IS NOT NULL GROUP BY TP_ESTADO_CIVIL_DESC ORDER BY media_lc DESC;",
    "reference_response": "Média de linguagens e códigos por estado civil."
  },
  {
    "query": "Quantos participantes nunca estudaram?",
    "expected_sql": "SELECT COUNT(*) as total_nunca_estudou FROM enem_2023_enriched WHERE Q001_DESC = 'Nunca estudou.';",
    "reference_response": "Total de participantes que nunca estudaram."
  },
  {
    "query": "Qual o ranking dos 10 melhores participantes em matemática?",
    "expected_sql": "SELECT NU_INSCRICAO, NU_NOTA_MT, SG_UF_PROVA, TP_SEXO_DESC FROM enem_2023_enriched WHERE NU_NOTA_MT IS NOT NULL ORDER BY NU_NOTA_MT DESC LIMIT 10;",
    "reference_response": "Top 10 participantes com maiores notas em matemática."
  },
  {
    "query": "Quantos participantes são de união estável?",
    "expected_sql": "SELECT COUNT(*) as total_uniao_estavel FROM enem_2023_enriched WHERE TP_ESTADO_CIVIL_DESC = 'União estável';",
    "reference_response": "Total de participantes em união estável."
  },
  {
    "query": "Qual a correlação entre matemática e ciências humanas?",
    "expected_sql": "SELECT NU_NOTA_MT, NU_NOTA_CH FROM enem_2023_enriched WHERE NU_NOTA_MT IS NOT NULL AND NU_NOTA_CH IS NOT NULL LIMIT 1000;",
    "reference_response": "Dados para análise de correlação entre matemática e ciências humanas."
  },
  {
    "query": "Quantos participantes têm ensino superior incompleto?",
    "expected_sql": "SELECT COUNT(*) as total_superior_incompleto FROM enem_2023_enriched WHERE Q001_DESC LIKE '%Superior incompleto%';",
    "reference_response": "Total de participantes com ensino superior incompleto."
  },
  {
    "query": "Qual a média de ciências humanas por nacionalidade?",
    "expected_sql": "SELECT TP_NACIONALIDADE_DESC, AVG(NU_NOTA_CH) as media_ch FROM enem_2023_enriched WHERE NU_NOTA_CH IS NOT NULL GROUP BY TP_NACIONALIDADE_DESC ORDER BY media_ch DESC;",
    "reference_response": "Média de ciências humanas por nacionalidade."
  },
  {
    "query": "Quantos participantes não fizeram nenhuma prova?",
    "expected_sql": "SELECT COUNT(*) as total_nenhuma_prova FROM enem_2023_enriched WHERE TP_PRESENCA_CN_DESC != 'Presente' AND TP_PRESENCA_CH_DESC != 'Presente' AND TP_PRESENCA_LC_DESC != 'Presente' AND TP_PRESENCA_MT_DESC != 'Presente';",
    "reference_response": "Total de participantes que não fizeram nenhuma prova."
  },
  {
    "query": "Qual o desvio padrão das notas de redação?",
    "expected_sql": "SELECT STDDEV(NU_NOTA_REDACAO) as desvio_redacao FROM enem_2023_enriched WHERE NU_NOTA_REDACAO IS NOT NULL;",
    "reference_response": "Desvio padrão das notas de redação."
  },
  {
    "query": "Quantos participantes concluíram em 2022?",
    "expected_sql": "SELECT COUNT(*) as total_2022 FROM enem_2023_enriched WHERE TP_ANO_CONCLUIU_DESC = '2022';",
    "reference_response": "Total de participantes que concluíram em 2022."
  },
  {
    "query": "Qual a média geral dos não treineiros?",
    "expected_sql": "SELECT AVG((NU_NOTA_CN + NU_NOTA_CH + NU_NOTA_LC + NU_NOTA_MT)/4) as media_nao_treineiros FROM enem_2023_enriched WHERE IN_TREINEIRO_DESC = 'Não' AND NU_NOTA_CN IS NOT NULL AND NU_NOTA_CH IS NOT NULL AND NU_NOTA_LC IS NOT NULL AND NU_NOTA_MT IS NOT NULL;",
    "reference_response": "Média geral dos participantes não treineiros."
  },
  {
    "query": "Quantos participantes são de cada dependência administrativa?",
    "expected_sql": "SELECT TP_DEPENDENCIA_ADM_ESC_DESC, COUNT(*) as total FROM enem_2023_enriched GROUP BY TP_DEPENDENCIA_ADM_ESC_DESC ORDER BY total DESC;",
    "reference_response": "Total de participantes por dependência administrativa da escola."
  },
  {
    "query": "Qual a nota mínima para estar no top 10% em matemática?",
    "expected_sql": "SELECT PERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY NU_NOTA_MT) as percentil_90_mt FROM enem_2023_enriched WHERE NU_NOTA_MT IS NOT NULL;",
    "reference_response": "Nota mínima para estar no top 10% em matemática."
  },
  {
    "query": "Quantos participantes têm pós-graduação?",
    "expected_sql": "SELECT COUNT(*) as total_pos_graduacao FROM enem_2023_enriched WHERE Q001_DESC LIKE '%Pós-graduação%';",
    "reference_response": "Total de participantes com pós-graduação."
  },
  {
    "query": "Qual a diferença de performance entre escolas urbanas e rurais?",
    "expected_sql": "SELECT TP_LOCALIZACAO_ESC_DESC, AVG(NU_NOTA_CN) as media_cn, AVG(NU_NOTA_CH) as media_ch, AVG(NU_NOTA_LC) as media_lc, AVG(NU_NOTA_MT) as media_mt, AVG(NU_NOTA_REDACAO) as media_redacao FROM enem_2023_enriched WHERE NU_NOTA_CN IS NOT NULL AND NU_NOTA_CH IS NOT NULL AND NU_NOTA_LC IS NOT NULL AND NU_NOTA_MT IS NOT NULL GROUP BY TP_LOCALIZACAO_ESC_DESC;",
    "reference_response": "Comparação de performance entre escolas urbanas e rurais."
  },
  {
    "query": "Quantos participantes estão cursando o ensino médio?",
    "expected_sql": "SELECT COUNT(*) as total_cursando FROM enem_2023_enriched WHERE TP_ST_CONCLUSAO_DESC = 'Estou cursando e concluirei o Ensino Médio em 2023';",
    "reference_response": "Total de participantes ainda cursando o ensino médio."
  },
  {
    "query": "Qual a nota média total (soma das 4 provas) por estado?",
    "expected_sql": "SELECT SG_UF_PROVA, AVG(NU_NOTA_CN + NU_NOTA_CH + NU_NOTA_LC + NU_NOTA_MT) as media_total FROM enem_2023_enriched WHERE NU_NOTA_CN IS NOT NULL AND NU_NOTA_CH IS NOT NULL AND NU_NOTA_LC IS NOT NULL AND NU_NOTA_MT IS NOT NULL GROUP BY SG_UF_PROVA ORDER BY media_total DESC;",
    "reference_response": "Média da soma das 4 provas por estado."
  },
  {
    "query": "Quantos participantes são do DF?",
    "expected_sql": "SELECT COUNT(*) as total_df FROM enem_2023_enriched WHERE SG_UF_PROVA = 'DF';",
    "reference_response": "Total de participantes do Distrito Federal."
  },
  {
    "query": "Qual a distribuição de cores de caderno por prova?",
    "expected_sql": "SELECT 'CN' as prova, CO_PROVA_CN_DESC as cor, COUNT(*) as total FROM enem_2023_enriched GROUP BY CO_PROVA_CN_DESC UNION SELECT 'CH', CO_PROVA_CH_DESC, COUNT(*) FROM enem_2023_enriched GROUP BY CO_PROVA_CH_DESC UNION SELECT 'LC', CO_PROVA_LC_DESC, COUNT(*) FROM enem_2023_enriched GROUP BY CO_PROVA_LC_DESC UNION SELECT 'MT', CO_PROVA_MT_DESC, COUNT(*) FROM enem_2023_enriched GROUP BY CO_PROVA_MT_DESC ORDER BY prova, total DESC;",
    "reference_response": "Distribuição de cores de caderno por prova."
  },
  {
    "query": "Quantos participantes têm ensino fundamental incompleto?",
    "expected_sql": "SELECT COUNT(*) as total_fund_incompleto FROM enem_2023_enriched WHERE Q001_DESC LIKE '%Ensino fundamental incompleto%';",
    "reference_response": "Total de participantes com ensino fundamental incompleto."
  }
]